(function(t,r){"use strict";function a(e,t,r,o){ga("send","event",e,t,r,o)}t.onerror=function(e,t,r){if(e){a("Error",e,t&&r?"["+t+":"+r+"]":"",true)}return false};t.AudioContext=t.AudioContext||t.webkitAudioContext;var o=function(e){try{var t="_";e.setItem(t,t);e.removeItem(t);return true}catch(e){return false}}(t.localStorage);if(t.location!==t.top.location||t.location.href&&!t.location.href.match(/https:\/\/playtictactoe\.org|neave\.local|192\.168/)){top.location.href="https://playtictactoe.org/"}(function(e,t,r,o,s,a,n){e["GoogleAnalyticsObject"]=s;e[s]=e[s]||function(){(e[s].q=e[s].q||[]).push(arguments)},e[s].l=1*new Date;a=t.createElement(r),n=t.getElementsByTagName(r)[0];a.async=1;a.src=o;n.parentNode.insertBefore(a,n)})(t,r,"script","https://www.google-analytics.com/analytics.js","ga");var e=r.getElementById("consent");var s=!!e;var n="UA-56095-18";t["ga-disable-"+n]=s;ga("set","anonymizeIp",true);ga("create",n,"auto");function i(){(t.adsbygoogle||[]).pauseAdRequests=0;t["ga-disable-"+n]=false;ga("send","pageview");if(s){r.body.classList.add("cookies-consent")}}function c(){if(!s||o&&localStorage.getItem("consent")){i()}else{e.addEventListener("click",function(){i();if(o){localStorage.setItem("consent",true)}})}}function u(t){var e=new XMLHttpRequest;e.open("GET","/assets/audio/"+t+".mp3",true);e.responseType="arraybuffer";e.onload=function(){g.decodeAudioData(e.response,function(e){v[t]=e},function(){})};e.send()}function y(e){if(q||!v[e]){return}if(g&&g.resume){g.resume()}var t=g.createBufferSource();t.buffer=v[e];t.connect(g.destination);if(t.start){t.start(0)}else{t.noteOn(0)}}var l={},f={player1:0,player2:0,ties:0},p={player1:0,player2:0,ties:0},d="x",m="o",v={},g,h=9,q,L,S=true,b=true,w=false,T=300,M=.75,k,A=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function D(){for(var e=l.mute.length;e--;){l.mute[e].style.display=q?"none":""}}function I(){q=!q;if(o){localStorage.setItem("muted",q.toString())}D();a("Mute",q?"muted":"unmuted")}function B(){w=!w;var e=l.scores.scores.classList;if(w){e.remove("p1");e.add("p2");b=true}else{e.remove("p2");e.add("p1");b=false}a("Mode",w?"players":"computer");l.scores.player1.innerHTML=w?p.player1:f.player1;l.scores.player2.innerHTML=w?p.player2:f.player2;l.scores.ties.innerHTML=w?p.ties:f.ties;L=false;j()}function E(e,t){l.squares[t].querySelector("div").classList.add(e)}function H(){var e=l.scores.turn1.classList,t=l.scores.turn2.classList,r=l.scores.turnTies.classList;if(w&&l.restart.style.display==="none"){if(S){t.remove("turn");e.add("turn")}else{e.remove("turn");t.add("turn")}r.add("turn")}else{e.remove("turn");t.remove("turn");r.remove("turn")}}function x(e){if(k[e]!==0||G()||!w&&S){return}if(w){S=!S;k[e]=S?-1:1;E(S?d:m,e);y("note-"+(S?"low":"high"));G()}else{k[e]=-1;E(d,e);S=true;y("note-low");setTimeout(N,T)}H()}function C(o,s){l.restart.style.display="block";setTimeout(function(){var e="Game",t=w?"players ":"computer ";setTimeout(function(){L=false},T);if(s){for(var r=3;r--;){l.squares[s[r]].querySelector("div").classList.add("blink")}}switch(o){case d:l.scores.player1.innerHTML=w?++p.player1:++f.player1;l.scores.player1.classList.add("appear");y("game-over");a(e,t+(w?d:"lose"));break;case m:l.scores.player2.innerHTML=w?++p.player2:++f.player2;l.scores.player2.classList.add("appear");y("game-over");a(e,t+(w?m:"win"));break;default:l.scores.ties.innerHTML=w?++p.ties:++f.ties;l.scores.ties.classList.add("appear");l.board.classList.add("blink");y("game-over-tie");a(e,t+"tie");break}},S&&!w?100:T+100)}function G(){for(var e=A.length;e--;){var t=A[e],r=k[t[0]]+k[t[1]]+k[t[2]];if(r===3||r===-3){C(r===3?m:d,t);return true}}var o=0;for(e=h;e--;){if(k[e]!==0){o++}}if(o===9){C();return true}return false}function N(){if(G()){return}var e,t,r,o,s,a,n=0;S=false;H();y("note-high");for(e=h;e--;){if(k[e]!==0){n++;if(n===1){a=e}}}if(n<2&&Math.random()>.2){do{s=Math.floor(Math.random()*h)}while(s===a)}else{for(e=h;e--;){for(t=h;t--;){if(k[t]!==0){continue}k[t]=1;if(G()){E(m,t);return}k[t]=0}if(k[e]!==0){continue}k[e]=1;var i=null,c=k.concat();for(t=h;t--;){if(c[t]!==0){continue}c[t]=-1;for(r=A.length;r--;){if(c[A[r][0]]+c[A[r][1]]+c[A[r][2]]===-3&&Math.random()>M){k[e]=0;k[t]=1;E(m,t);G();return}}var u=0,l=0,f=c.concat(),p=c.concat();for(r=h;r--;){if(f[r]===0){f[r]=1}if(p[r]===0){p[r]=-1}}for(r=A.length;r--;){if(f[A[r][0]]+f[A[r][1]]+f[A[r][2]]===3){u++}if(p[A[r][0]]+p[A[r][1]]+p[A[r][2]]===-3){l++}}var d=u-l;i=i==null?d:i>d?d:i;c[t]=0}if(o==null||o<i){o=i;s=e}k[e]=0}}k[s]=1;E(m,s);G()}function O(t){l.squares[t].ontouchstart=l.squares[t].onmousedown=function(e){e.preventDefault();x(t)}}function j(){if(L){return}L=true;l.restart.style.display="none";k=[0,0,0,0,0,0,0,0,0];for(var e=h;e--;){l.squares[e].querySelector("div").className=""}l.scores.ties.classList.remove("appear");l.scores.player1.classList.remove("appear");l.scores.player2.classList.remove("appear");l.board.classList.remove("blink");S=b=!b;H();if(b&&!w){setTimeout(N,T)}}r.addEventListener("DOMContentLoaded",function(){l={board:r.querySelector(".board"),squares:r.querySelectorAll(".square"),restart:r.querySelector(".restart"),muteButton:r.querySelector(".mute"),mute:r.querySelectorAll(".mute path"),privacy:r.querySelector(".privacy"),scores:{scores:r.querySelector(".scores"),swap:r.querySelector(".swap"),player1:r.querySelector(".player1 .score"),player2:r.querySelector(".player2 .score"),ties:r.querySelector(".ties .score"),turn1:r.querySelector(".player1"),turn2:r.querySelector(".player2"),turnTies:r.querySelector(".ties")}};for(var e=h;e--;){O(e)}l.restart.ontouchstart=l.scores.scores.ontouchstart=function(e){e.preventDefault()};l.scores.scores.ontouchend=l.scores.scores.onclick=function(e){e.preventDefault();B()};l.restart.ontouchend=l.restart.onclick=function(e){e.preventDefault();j()};if(t.AudioContext){g=new AudioContext;u("note-high");u("note-low");u("game-over");u("game-over-tie");q=o?localStorage.getItem("muted")==="true":false;D();l.muteButton.ontouchstart=l.muteButton.onclick=function(e){e.preventDefault();I()}}c();j()})})(window,document);